<!doctype html>
<html lang="zh" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <title>日期计算器</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet/less" type="text/css" href="less/styles.less" />
    <link rel="stylesheet" href="vendor/swiper-bundle.css" />
    <script src="vendor/less.js"></script>
  </head>
  <body>
    <main>
      <label for="in-date-start">
        开始日期
        <input type="date" name="start" id="in-date-start" />
      </label>
      <p>相差<span data-diff-in-days>0</span>天</p>
      <label for="in-date-end">
        结束日期
        <input type="date" name="end" id="in-date-end" />
      </label>
    </main>
    <section class="month">
      <h3>2024年2月</h3>
      <ul class="day-grid">
        <li class="day-grid--day"></li>
      </ul>
    </section>
  </body>
  <script src="vendor/jquery.js"></script>
  <script type="module">
    import { daysBetween } from "./js/date-util.js";

    const $dateStart = $("#in-date-start");
    const $dateEnd = $("#in-date-end");
    const $diffInDays = $("[data-diff-in-days]");

    function updateDateDiff() {
      const startIsSet = $dateStart.val() !== "";
      const endIsSet = $dateEnd.val() !== "";
      const bothDatesAreSet = startIsSet && endIsSet;
      if (!bothDatesAreSet) {
        return;
      }

      $diffInDays.text(daysBetween($dateStart.val(), $dateEnd.val()));
    }

    $dateStart.on("change", updateDateDiff);
    $dateEnd.on("change", updateDateDiff);
  </script>
  <script>
    function createCalendar() {}

    const $calendar = $(".day-grid");
    for (let i = 0; i < 35 - 1; i++) {
      const $d = $calendar.children(".day-grid--day").eq(0).clone();
      $d.appendTo($calendar);
    }
    const firstDayWeekDay = 4;
    const today = 14;
    const lastDay = 29;
    for (
      let cell = firstDayWeekDay, day = 1;
      cell <= 35 && day <= lastDay;
      cell++
    ) {
      const $d = $calendar.children(".day-grid--day").eq(cell - 1);
      $d.text(day);
      if (day === today) {
        $d.addClass("day-grid--day__today");
      } else if (day > today) {
        $d.addClass("day-grid--day__disable");
      } else if (day === 9) {
        $d.addClass("day-grid--day__selected");
      }

      day++;
    }
  </script>
</html>
